<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:cxf-camel="http://camel.apache.org/schema/cxf"
       xmlns:cxf-http-conf="http://cxf.apache.org/transports/http/configuration"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
            http://camel.apache.org/schema/cxf http://camel.apache.org/schema/cxf/camel-cxf.xsd
            http://cxf.apache.org/transports/http/configuration http://cxf.apache.org/schemas/configuration/http-conf.xsd">

    <import resource="classpath:META-INF/cxf/cxf.xml"/>
    <import resource="classpath:META-INF/cxf/cxf-servlet.xml"/>

    <!--
     For CXF endpoint definitions made like this, the address attribute is host/port-relative.Cf
     http://qnalist.com/questions/2220245/cxf-endpoint-no-service-was-found-issue.

      The serviceName attribute is required, even though it's specified in the WSDL.  And because you can't
      currently include namespace definitions in this attribute, e.g. "http:{bla}serviceName", you need to declare
      the namespace by an xmlns: declaration.
    -->
    <cxf-camel:cxfEndpoint id="processPendingArrangementEvent" address="/service"
                           serviceClass="lib_sim_salesprocessmanagement.ia_processpendingarrangementevent.IAProcessPendingArrangementEvent"
                           serviceName="s:TSK_SalesProcessManagement_IA_ProcessPendingArrangementEventExport1"
                           xmlns:s="http://LIB_SIM_SalesProcessManagement/IA_ProcessPendingArrangementEvent/Binding">

        <cxf-camel:properties>
            <entry key="faultStackTraceEnabled" value="true"/>
        </cxf-camel:properties>

        <cxf-camel:features>
            <bean class="org.apache.cxf.feature.StaxTransformFeature">
                <!-- Real clients may send messages which namespace the request element wrongly. -->
                <property name="inTransformElements">
                    <map>
                        <entry key="{http://LB_GBO_Sales/Messages}request" value="request"/>
                    </map>
                </property>
                <property name="outAppendElements">
                    <map>
                        <entry key="{http://schemas.xmlsoap.org/soap/envelope/}Body"
                               value="{http://schemas.xmlsoap.org/soap/envelope/}Header="/>
                    </map>
                </property>
            </bean>
        </cxf-camel:features>
        <cxf-camel:outFaultInterceptors>
            <bean class="com.lloydsbanking.salsa.interceptors.fault.CxfFaultOutInterceptor"/>
        </cxf-camel:outFaultInterceptors>
    </cxf-camel:cxfEndpoint>

    <cxf-http-conf:conduit name="*.http-conduit">
        <cxf-http-conf:tlsClientParameters disableCNCheck="true" useHttpsURLConnectionDefaultSslSocketFactory="true"/>
    </cxf-http-conf:conduit>
</beans>
